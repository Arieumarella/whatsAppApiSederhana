# Development override: mount host project for live edits and enable headful browser
services:
  app:
    environment:
      HEADLESS: "false"
      PUPPETEER_DEVTOOLS: "true"
      DISPLAY: ${DISPLAY:-:0}
      PUPPETEER_ARGS: "--no-sandbox,--disable-setuid-sandbox,--disable-gpu"
    user: "${LOCAL_UID:-1000}:${LOCAL_GID:-1000}"
    volumes:
      # Mount project for development (live code). Be aware this hides files copied into the image.
      - ./:/app:rw
      # Preserve container-installed node_modules (prevent host from overwriting)
      - /app/node_modules
      # Keep session in the named docker volume (avoid host permission issues)
      - session-data:/app/session
      # Mount X11 socket & Xauthority for host X forwarding (optional)
      - /tmp/.X11-unix:/tmp/.X11-unix:ro
      - ${XAUTHORITY:-/home/${USER}/.Xauthority}:/home/pptruser/.Xauthority:ro
    # Uncomment devices if your host provides DRM device and you want hardware acceleration
    # devices:
    #   - /dev/dri:/dev/dri
    # If your Docker host requires additional privileges for GUI, you may add:
    # cap_add:
    #   - SYS_ADMIN
